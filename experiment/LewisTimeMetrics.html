<html>
<head>
	<title>Decision-Making Survey</title>
    <!-- jQuery -->
    <script src="mmturkey.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
	<link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/black-tie/jquery-ui.min.css" rel="stylesheet" type="text/css"></link>
	<link rel="stylesheet" href="style.css"/>

	<!-- jsPsych -->
	<script src="jsPsych-4.0.1/jspsych.js"></script>
	<script src="jsPsych-4.0.1/plugins/jspsych-survey-likert.js"></script>
    <script src="jsPsych-4.0.1/plugins/jspsych-survey-text.js"></script>
	<script src="jsPsych-4.0.1/plugins/jspsych-single-stim.js"></script>
	<script src="jsPsych-4.0.1/plugins/jspsych-text.js"></script>
    <script src="jsPsych-4.0.1/plugins/jspsych-html.js"></script>
	<!-- style -->
	<link href="jsPsych-4.0.1/css/jspsych.css" rel="stylesheet" type="text/css"></link>

</head>
<body>
<div class="slide" id="instructions">
	<img src="images/stanford.png" alt="Stanford University">
    <p id='logo-text'>Future Decisions Study</p>
    <p class="block-text">In this study, you will read about events that may or may not happen to you in the future. You will also respond to questions about your personality and preferences.
    </p>
    <button type="button" onclick="this.blur(); experiment.task()">Start</button>

    <p class="block-text" id="legal">Legal information: By answering the following questions, you are participating in a study being performed by the Stanford University Department of Psychology. If you have questions about this research, please contact us at <a href="mailto://stanfordpsych254@gmail.com">stanfordpsych254@gmail.com</a>. You must be at least 18 years old to participate. Your participation in this research is voluntary. You may decline further participation, at any time, without adverse consequences. Your anonymity is assured; the researchers who have requested your participation will not receive any personal information about you. Note however that we have recently been made aware that your public Amazon.com profile can be accessed via your worker ID if you do not choose to opt out. If you would like to opt out of this feature, you may follow instructions available <a href="https://www.amazon.com/gp/help/customer/display.html?nodeId=16465241">here</a>.
    </p>
</div>
<script src="experiment.js"></script>
</body>

<div class = "slide" id="task">
	<div id="jspsych_target"> 
	</div>
</div>


</html>

<script type="text/javascript">

// Random assignment to condition 

if (Math.random() < 0.5){
    var timeMetric = "gross";
} 
else {
    var timeMetric = "fine";
};

if(Math.random() < 0.5){
    var incrAction = "overall";
} else {
    var incrAction = "incremental";
};


if(timeMetric == "fine") {
	var metric = "10,950 days";
} else {
	var metric = "30 years";
};

if(metric == "10,950 days") {
	var timeFrame = "days";
} else {
	var timeFrame = "years";
};


if(incrAction == "incremental") {
	if(timeMetric == "fine") {
		var action = "per day";
	} else {
		var action = "per year";}
}
else {
    var action = "overall";
};

var condition = timeMetric + incrAction;

var the_experiment = [];

var instruct = {
    type:'text',  //which plugin file to use to run the trial
    text: ['<br><center><p>Please read the following scenario carefully and respond to the questions that follow.</p><p>Press ENTER to continue</p></center>'], //literally the text to display for the question
    timing_post_trial:0,
    cont_key: 13}; //key to press to move on
the_experiment.push(instruct); //pushing the trial instruct



//Vignette and DVs

var vignette = "<center><p>Imagine you plan to retire. You realize you will be ready for retirement in only " + [metric] + ".</p></center>"

var questionOpen = "<center><br>Please answer the following questions.</center>"

var savingQuestions = [vignette + questionOpen + "<br>When should you begin saving for retirement? In ___ " + [timeFrame] + ".", "<br>How much should you save (in U.S. dollars) " + [action] + " for your retirement?"];

var surveySaving = {
    type: 'survey-text',
    questions: [savingQuestions],
    };
the_experiment.push(surveySaving);



//Demographics


var surveyAge = {
    type: 'survey-text',
    questions: [["Please respond to the following questions about yourself.<br><br>What is your age?"]],
}
the_experiment.push(surveyAge);


var demoQuestions = ["Please respond to the following questions about yourself. <br><br>Indicate the highest level of education you have achieved.", "<br><br>Indicate your household income."];

var d1 = ["high school diploma or less", "some college or technical school", "college degree", "some post-graduate", "post-graduate degree (e.g., Masters, Ph.D., J.D.)"];
var d2 = ["<$25,000", "$25-$49,999", "$50-$74,999", "$75-$99,999", "$100,000+"];

var surveyDemos = {
            type: 'survey-likert',
            questions: [demoQuestions],
            labels:[[d1, d2]], // need one scale for every question on a page
            intervals:[[5, 5]], // note the the intervals and labels don't necessarily need to match.
        };
the_experiment.push(surveyDemos);

var debriefing = {
    type: 'text',
    text: "<center>Thank your for your participation! <br><br> Press ENTER to submit.</center>",
    timing_post_trial:0,
    cont_key: 13
};
the_experiment.push(debriefing);

jsPsych.init({
    display_element: $('#jspsych_target'),
    show_progress_bar: true,
    experiment_structure: the_experiment,
    on_finish: function() {
        var alldata = jsPsych.data.getData();
        alldata.push({condition: condition})
        alldata.push({timeMetric: timeMetric})  
        alldata.push({metric: metric})  
        alldata.push({timeFrame: timeFrame})
        alldata.push({incrAction: incrAction}) 
        alldata.push({action: action})    
        turk.submit(alldata)
        jsPsych.data.displayData('json')
		}
	});
</script>
